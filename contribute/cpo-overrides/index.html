
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Developer preview documentation for HyperShift on Azure" name="description"/>
<meta content="HyperShift Community" name="author"/>
<link href="https://hypershift-community.github.io/azure-dev-preview/contribute/cpo-overrides/" rel="canonical"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.8" name="generator"/>
<title>CPO Overrides Configuration Guide - HyperShift Azure Developer Preview</title>
<link href="../../assets/stylesheets/main.8608ea7d.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../custom.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
 <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#overview">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="HyperShift Azure Developer Preview" class="md-header__button md-logo" data-md-component="logo" href="../.." title="HyperShift Azure Developer Preview">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            HyperShift Azure Developer Preview
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              CPO Overrides Configuration Guide
            
          </span>
</div>
</div>
</div>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/hypershift-community/azure-dev-preview" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    hypershift-community/azure-dev-preview
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
        
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../how-to/azure/self-managed/01-understanding/">
        
  
    
  
  Understanding

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../how-to/azure/self-managed/02-planning/">
        
  
    
  
  Planning

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../how-to/azure/self-managed/03-azure-foundation/">
        
  
    
  
  Azure Setup

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../how-to/azure/self-managed/04-management-cluster/">
          
  
    
  
  Management &amp; Hosted Clusters

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../how-to/azure/self-managed/07-troubleshooting/">
          
  
    
  
  Reference

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="HyperShift Azure Developer Preview" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="HyperShift Azure Developer Preview">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    HyperShift Azure Developer Preview
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/hypershift-community/azure-dev-preview" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    hypershift-community/azure-dev-preview
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Home
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../how-to/azure/self-managed/01-understanding/">
<span class="md-ellipsis">
    Understanding
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../how-to/azure/self-managed/02-planning/">
<span class="md-ellipsis">
    Planning
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../how-to/azure/self-managed/03-azure-foundation/">
<span class="md-ellipsis">
    Azure Setup
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    Management &amp; Hosted Clusters
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Management &amp; Hosted Clusters
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../how-to/azure/self-managed/04-management-cluster/">
<span class="md-ellipsis">
    Management Cluster
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../how-to/azure/self-managed/05-hosted-cluster/">
<span class="md-ellipsis">
    Create Hosted Cluster
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../how-to/azure/self-managed/06-day2-operations/">
<span class="md-ellipsis">
    Day 2 Operations
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-ellipsis">
    Reference
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Reference
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../how-to/azure/self-managed/07-troubleshooting/">
<span class="md-ellipsis">
    Troubleshooting
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../how-to/azure/self-managed/08-reference/">
<span class="md-ellipsis">
    Reference
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
<span class="md-ellipsis">
      Overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#configuration-file-structure">
<span class="md-ellipsis">
      Configuration File Structure
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#configuration-elements">
<span class="md-ellipsis">
      Configuration Elements
    </span>
</a>
<nav aria-label="Configuration Elements" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#platforms-section">
<span class="md-ellipsis">
      Platforms Section
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#platform-configuration">
<span class="md-ellipsis">
      Platform Configuration
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#configuration-examples">
<span class="md-ellipsis">
      Configuration Examples
    </span>
</a>
<nav aria-label="Configuration Examples" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-platform-specific-override">
<span class="md-ellipsis">
      Basic Platform-Specific Override
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multiple-versions-and-platforms">
<span class="md-ellipsis">
      Multiple Versions and Platforms
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-it-works">
<span class="md-ellipsis">
      How It Works
    </span>
</a>
<nav aria-label="How It Works" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#image-resolution-process">
<span class="md-ellipsis">
      Image Resolution Process
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#platform-handling">
<span class="md-ellipsis">
      Platform Handling
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#enabling-cpo-overrides">
<span class="md-ellipsis">
      Enabling CPO Overrides
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#file-locations">
<span class="md-ellipsis">
      File Locations
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#best-practices">
<span class="md-ellipsis">
      Best Practices
    </span>
</a>
<nav aria-label="Best Practices" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#version-management">
<span class="md-ellipsis">
      Version Management
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#image-references">
<span class="md-ellipsis">
      Image References
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#platform-configuration_1">
<span class="md-ellipsis">
      Platform Configuration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#testing">
<span class="md-ellipsis">
      Testing
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#troubleshooting">
<span class="md-ellipsis">
      Troubleshooting
    </span>
</a>
<nav aria-label="Troubleshooting" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#common-issues">
<span class="md-ellipsis">
      Common Issues
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#securityproduction-considerations">
<span class="md-ellipsis">
      Security/Production Considerations
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="cpo-overrides-configuration-guide">CPO Overrides Configuration Guide</h1>
<h2 id="overview">Overview</h2>
<p>The CPO (Control Plane Operator) overrides mechanism allows you to specify custom Control Plane Operator images for specific OpenShift versions and platforms. This is particularly useful for applying hotfixes and patches before they're officially released.</p>
<h2 id="configuration-file-structure">Configuration File Structure</h2>
<p>The CPO overrides are configured using a YAML file with the following structure:</p>
<div class="highlight"><pre><span></span><code><span class="nt">platforms</span><span class="p">:</span>
<span class="w">  </span><span class="nt">aws</span><span class="p">:</span>
<span class="w">    </span><span class="nt">overrides</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">"4.17.9"</span>
<span class="w">        </span><span class="nt">cpoImage</span><span class="p">:</span><span class="w"> </span><span class="s">"quay.io/hypershift/control-plane-operator:4.17.9"</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">"4.17.8"</span>
<span class="w">        </span><span class="nt">cpoImage</span><span class="p">:</span><span class="w"> </span><span class="s">"quay.io/hypershift/control-plane-operator:4.17.8"</span>
<span class="w">    </span><span class="nt">testing</span><span class="p">:</span>
<span class="w">      </span><span class="nt">latest</span><span class="p">:</span><span class="w"> </span><span class="s">"quay.io/openshift-release-dev/ocp-release:4.17.9-x86_64"</span>
<span class="w">      </span><span class="nt">previous</span><span class="p">:</span><span class="w"> </span><span class="s">"quay.io/openshift-release-dev/ocp-release:4.17.8-x86_64"</span>
<span class="w">  </span><span class="nt">azure</span><span class="p">:</span>
<span class="w">    </span><span class="nt">overrides</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">"4.16.17"</span>
<span class="w">        </span><span class="nt">cpoImage</span><span class="p">:</span><span class="w"> </span><span class="s">"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:1a50894aafa6b750bf890ef147a20699ff5b807e586d15506426a8a615580797"</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">"4.16.18"</span>
<span class="w">        </span><span class="nt">cpoImage</span><span class="p">:</span><span class="w"> </span><span class="s">"quay.io/hypershift/hypershift-cpo:patch"</span>
</code></pre></div>
<h2 id="configuration-elements">Configuration Elements</h2>
<h3 id="platforms-section">Platforms Section</h3>
<p>The top-level <code>platforms</code> section contains platform-specific configurations. Currently supported platforms:</p>
<ul>
<li><strong><code>aws</code></strong>: Amazon Web Services</li>
<li><strong><code>azure</code></strong>: Microsoft Azure</li>
</ul>
<p>Each platform section is optional. If a platform is not configured, the default CPO image from the OpenShift release will be used.</p>
<h3 id="platform-configuration">Platform Configuration</h3>
<p>Each platform can contain:</p>
<h4 id="overrides-array"><code>overrides</code> (Array)</h4>
<p>A list of version-specific CPO image overrides:</p>
<ul>
<li><strong><code>version</code></strong> (string): The exact OpenShift version (e.g., "4.17.9", "4.16.17")</li>
<li><strong><code>cpoImage</code></strong> (string): The full container image reference to use for this version</li>
</ul>
<h4 id="testing-object-optional"><code>testing</code> (Object, Optional)</h4>
<p>Configuration for automated testing:</p>
<ul>
<li><strong><code>latest</code></strong> (string): The latest OpenShift release image for testing</li>
<li><strong><code>previous</code></strong> (string): The previous OpenShift release image for testing</li>
</ul>
<h2 id="configuration-examples">Configuration Examples</h2>
<h3 id="basic-platform-specific-override">Basic Platform-Specific Override</h3>
<div class="highlight"><pre><span></span><code><span class="nt">platforms</span><span class="p">:</span>
<span class="w">  </span><span class="nt">aws</span><span class="p">:</span>
<span class="w">    </span><span class="nt">overrides</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">"4.17.9"</span>
<span class="w">        </span><span class="nt">cpoImage</span><span class="p">:</span><span class="w"> </span><span class="s">"quay.io/myorg/custom-cpo-aws:4.17.9"</span>
</code></pre></div>
<h3 id="multiple-versions-and-platforms">Multiple Versions and Platforms</h3>
<div class="highlight"><pre><span></span><code><span class="nt">platforms</span><span class="p">:</span>
<span class="w">  </span><span class="nt">aws</span><span class="p">:</span>
<span class="w">    </span><span class="nt">overrides</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">"4.17.9"</span>
<span class="w">        </span><span class="nt">cpoImage</span><span class="p">:</span><span class="w"> </span><span class="s">"quay.io/hypershift/control-plane-operator-aws:4.17.9"</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">"4.17.8"</span>
<span class="w">        </span><span class="nt">cpoImage</span><span class="p">:</span><span class="w"> </span><span class="s">"quay.io/hypershift/control-plane-operator-aws:4.17.8"</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">"4.16.15"</span>
<span class="w">        </span><span class="nt">cpoImage</span><span class="p">:</span><span class="w"> </span><span class="s">"quay.io/hotfix/cpo-aws:4.16.15-hotfix"</span>
<span class="w">    </span><span class="nt">testing</span><span class="p">:</span>
<span class="w">      </span><span class="nt">latest</span><span class="p">:</span><span class="w"> </span><span class="s">"quay.io/openshift-release-dev/ocp-release:4.17.9-x86_64"</span>
<span class="w">      </span><span class="nt">previous</span><span class="p">:</span><span class="w"> </span><span class="s">"quay.io/openshift-release-dev/ocp-release:4.17.8-x86_64"</span>
<span class="w">  </span><span class="nt">azure</span><span class="p">:</span>
<span class="w">    </span><span class="nt">overrides</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">"4.17.9"</span>
<span class="w">        </span><span class="nt">cpoImage</span><span class="p">:</span><span class="w"> </span><span class="s">"quay.io/hypershift/control-plane-operator-azure:4.17.9"</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">"4.16.20"</span>
<span class="w">        </span><span class="nt">cpoImage</span><span class="p">:</span><span class="w"> </span><span class="s">"quay.io/security-fix/cpo-azure:4.16.20-security"</span>
</code></pre></div>
<h2 id="how-it-works">How It Works</h2>
<h3 id="image-resolution-process">Image Resolution Process</h3>
<ol>
<li><strong>Override Check</strong>: When a HostedCluster is created or updated, the system checks if CPO overrides are enabled</li>
<li><strong>Platform Lookup</strong>: The system looks up overrides for the specific platform (case-insensitive)</li>
<li><strong>Version Match</strong>: If the platform exists, it searches for an exact version match</li>
<li><strong>Fallback</strong>: If no override is found, the default CPO image from the OpenShift release is used</li>
</ol>
<h3 id="platform-handling">Platform Handling</h3>
<ul>
<li>Platform names are <strong>case-insensitive</strong> (<code>AWS</code>, <code>aws</code>, <code>Aws</code> all work)</li>
<li>Unknown platforms return empty string (graceful degradation)</li>
<li>Missing platforms in configuration are handled safely (no panics)</li>
</ul>
<h2 id="enabling-cpo-overrides">Enabling CPO Overrides</h2>
<p>CPO overrides are controlled by an environment variable on the HyperShift operator:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">ENABLE_CPO_OVERRIDES</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<p>When this environment variable is set to <code>1</code>, the override system is activated. Without this variable, all overrides are ignored and default images are used.</p>
<h2 id="file-locations">File Locations</h2>
<p>The override configuration files are embedded in the binary at build time:</p>
<p><code>hypershift-operator/controlplaneoperator-overrides/assets/overrides.yaml</code></p>
<h2 id="best-practices">Best Practices</h2>
<h3 id="version-management">Version Management</h3>
<ul>
<li>Use exact version strings (e.g., "4.17.9", not "4.17.x")</li>
<li>Keep override lists sorted by version for maintainability</li>
</ul>
<h3 id="image-references">Image References</h3>
<ul>
<li>Use full image references including registry and tag/digest</li>
<li>Prefer digest references for production overrides for immutability</li>
</ul>
<h3 id="platform-configuration_1">Platform Configuration</h3>
<ul>
<li>Only configure platforms that need overrides</li>
<li>Keep platform-specific testing configurations separate</li>
<li>Document the purpose of each override in comments</li>
</ul>
<h3 id="testing">Testing</h3>
<ul>
<li>The test section allows specifying a pair of release images to use for a single hypershift e2e test run. Currently only a single pair can be specified per platform. If multiple releases need to be tested, create a clone of your override PR and specify a different pair of images to test in the clone. The clone shouldn't be merged, it should
only be used for testing.</li>
</ul>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="common-issues">Common Issues</h3>
<ol>
<li><strong>Override Not Applied</strong></li>
<li>Check if <code>ENABLE_CPO_OVERRIDES=1</code> is set</li>
<li>Verify platform name matches exactly (case-insensitive)</li>
<li>
<p>Confirm version string is exact match</p>
</li>
<li>
<p><strong>Image Pull Failures</strong></p>
</li>
<li>Verify image exists and is accessible</li>
<li>Check image registry authentication</li>
<li>
<p>Validate image digest/tag is correct</p>
</li>
<li>
<p><strong>Platform Not Found</strong></p>
</li>
<li>Returns empty string (safe fallback)</li>
<li>Check platform configuration in YAML</li>
<li>Verify platform name spelling</li>
</ol>
<h2 id="securityproduction-considerations">Security/Production Considerations</h2>
<ul>
<li>Only use trusted image registries for CPO overrides</li>
<li>Validate override images are signed and verified</li>
<li>If multiple architectures are supported in the data plane, ensure that override image references point to multi-arch repositories that have all architectures supported in the data plane.</li>
</ul>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.indexes", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
<script src="https://unpkg.com/mermaid@11.2.0/dist/mermaid.min.js"></script>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>